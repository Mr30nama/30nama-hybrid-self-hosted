import{d as Z,b as K,c as C,r as L,g as v,h as m,k as d,i as b,j as f,F as q,A as z,t as x,N as Q,E as D,p as oe,q as se,s as ne,C as ie,ap as le,Q as ae,a as re,a8 as ue,aq as ce,a5 as de,e as fe,V as pe,o as _e,K as N,aa as ve,ae as me,f as ge,a9 as he,z as W,l as ye,m as be,$ as xe,v as we,O as ke,P as $e,n as Le}from"./entry.771bd3e6.js";import{_ as Ee}from"./PlayerMain.vue.afd6cf67.js";import{_ as Se}from"./FormDropdown.vue.169fb3ef.js";import{u as U}from"./useBackground.9ab5ec82.js";const O=w=>(oe("data-v-f49de26d"),w=w(),se(),w),Ie={id:"episode-section",class:"local-numbers my-12 flex min-h-full w-full cursor-default flex-col overflow-visible rounded-xl pb-32",tabindex:"-1"},Ne={class:"relative z-10 -mb-20 flex w-full justify-end"},Ce={class:"flex w-full flex-col flex-nowrap gap-12 overflow-y-auto px-2"},Pe={class:"items- relative flex w-full flex-col flex-nowrap overflow-visible p-4"},He={class:"relative mx-4 flex items-center"},je={class:"text-fonts-50 whitespace-nowrap rounded-xl rounded-b-none p-2 px-4 text-3xl font-semibold"},Ae={class:"text-fonts-50 relative flex text-3xl font-bold"},Be=O(()=>d("span",{class:"bg-bg-1 absolute top-1/3 h-3 w-3 rounded-full blur-lg ltr:left-1/2 rtl:right-1/2"},null,-1)),De={class:"flex flex-row flex-wrap items-center gap-8 px-8 !text-base"},Oe=["onClick"],Re=O(()=>d("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 0H0V30H8L8 8.34204L8 0ZM8 8.34204L7.99611 8.34485L7.99914 8.34212L7.99914 4C7.99914 6.92963 6.92984 8.96704 6.14398 9.93857C6.02543 10.063 5.91246 10.1875 5.80492 10.312C5.78418 10.3319 5.76392 10.3507 5.74418 10.3684L5.7979 10.3201C2.85283 13.7386 3.99163 17.1976 5.90023 19.4823L5.74423 19.3421C6.49593 20.0176 7.99914 22.2948 7.99914 25.9999L7.99914 21.3683L7.99706 21.3665L8 21.3684L8 8.34204Z"},null,-1)),Te=[Re],Me=O(()=>d("span",{class:"bg-primary-500 shadow-primary-500 absolute top-1/2 h-[60%] w-[2px] -translate-y-1/2 rounded-full opacity-100 shadow-[0_0_8px_1px] ltr:left-1 rtl:right-1"},null,-1)),Ve=Z({__name:"PlayerEpisode",props:{selectedEpisode:{},data:{}},emits:["selected"],setup(w,{emit:h}){const{t:S}=K(),P=w,H=h,y=C(()=>{const a={};for(const u of P.data)u.season&&(a[u.season.toString()]||(a[u.season.toString()]=[]),a[u.season.toString()].push(u));return a}),j=C(()=>Object.keys(y.value).map(a=>({value:a,title:`${S("season")} ${a}`}))),k=L("ALL");return(a,u)=>{const $=Se;return v(),m("div",Ie,[d("div",Ne,[b($,{title:a.$t("season"),list:f(j),searchable:"","has-default-all":"",style:{foreground:"bg-bg-11"},onOnChange:u[0]||(u[0]=g=>k.value=g[0])},null,8,["title","list"])]),d("div",Ce,[(v(!0),m(q,null,z(f(k)!="ALL"?{[f(k)]:f(y)[f(k)]}:f(y),(g,n)=>(v(),m("section",{key:n,"aria-label":"item",class:"flex w-full flex-col gap-8 text-base"},[d("header",Pe,[d("div",He,[d("h6",je,x(a.$t("season")),1),d("span",Ae,[Q(x(n)+" ",1),Be])])]),d("ul",De,[(v(!0),m(q,null,z(g,p=>(v(),m("li",{key:p.file_id,class:D(["bg-bg-11 hover:bg-bg-10 group relative flex min-w-[12em] !cursor-pointer justify-center rounded-xl py-3 opacity-90 transition-colors hover:opacity-100 ltr:rounded-l-none rtl:rounded-r-none",{"!bg-bg-9 selected-episode !cursor-default !opacity-100":p.file_id===a.selectedEpisode}]),onClick:c=>H("selected",p.file_id)},[(v(),m("svg",{class:D(["fill-bg-11 group-hover:fill-bg-10 absolute top-0 h-full rounded-r-xl transition-colors ltr:right-full ltr:translate-x-[1px] ltr:rotate-180 rtl:left-full rtl:translate-x-[-1px]",{"!fill-bg-9 ":p.file_id===a.selectedEpisode}]),viewBox:"0 0 8 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Te,2)),Me,d("p",{class:D(["opacity-80",{"!opacity-100":p.file_id===a.selectedEpisode}])},x(a.$t("episode"))+" "+x(p.episode),3)],10,Oe))),128))])]))),128))])])}}});const Fe=ne(Ve,[["__scopeId","data-v-f49de26d"]]),qe={class:"relative flex h-full w-full items-center justify-center"},ze={key:0,class:"flex w-full flex-col items-center justify-center gap-4"},We={key:1,class:"absolute flex flex-col items-center gap-2 text-2xl"},Ue=d("span",{class:"cover-2 absolute inset-0 z-40 bg-bg-12 opacity-0"},null,-1),Ze={key:2,class:"h-full w-full"},Xe=Z({__name:"[id]",setup(w){const h=ie(),S=L(!1),P=le(),H=ae(),y=re(),{t:j}=K(),k=ue(),a=xe(),u=ce(),{isInactive:$}=de(),g=C(()=>y.params.id),n=L(),p=L(!0),c=L(),E=L();let G;fe({title:()=>{var o,e,t;return`${j("seo.30nama")} | ${(o=n.value)!=null&&o.result.info.title?((e=n.value)==null?void 0:e.result.info.title.local)??((t=n.value)==null?void 0:t.result.info.title.english):""}`}});function J(o){var t,l,i,r,_;const e=(t=n.value)==null?void 0:t.result;if(e!=null&&e.continue_watching)if(o){let s=e.hls.find(B=>{var F;return B.info.file_id===((F=e.continue_watching)==null?void 0:F.file_id)});s||(s=e.hls[0]);const I=s.info.file_id===e.hls[e.hls.length-1].info.file_id;return{vast2:e.vast2,image:{cover:((l=e.image.cover)==null?void 0:l.jpg)||"",cover_webp:((i=e.image.cover)==null?void 0:i.webp)||""},info:{displayName:s.info.episode_name||"",title:e.info.title.local||e.info.title.english,file_id:s.info.file_id,post_id:e.info.post_id,isSeries:o,time:e.continue_watching.time},options:{isLastEpisode:I,intro_end:s.options.intro_end,intro_start:s.options.intro_start,previously_start:s.options.previously_start,previously_end:s.options.previously_end,end:s.options.end,token:s.options.token},subtitle:{...s.file.subtitle},file:{m3u8:s.file.m3u8}}}else{const s=e.hls[0];return{vast2:e.vast2,image:{cover:((r=e.image.cover)==null?void 0:r.jpg)||"",cover_webp:((_=e.image.cover)==null?void 0:_.webp)||""},info:{displayName:e.info.title.local||e.info.title.english,title:"",file_id:s.info.file_id,post_id:e.info.post_id,isSeries:o,time:e.continue_watching.time},options:{intro_end:s.options.intro_end,intro_start:s.options.intro_start,previously_start:s.options.previously_start,previously_end:s.options.previously_end,end:s.options.end,token:s.options.token},subtitle:{...s.file.subtitle},file:{m3u8:s.file.m3u8}}}}function X(o){var l,i,r;const e=(l=n.value)==null?void 0:l.result;if(!e)return;const t=e.hls[0];return{vast2:e.vast2,image:{cover:((i=e.image.cover)==null?void 0:i.jpg)??"",cover_webp:((r=e.image.cover)==null?void 0:r.webp)??""},info:{displayName:t.info.episode_name||"",title:e.info.title.local||e.info.title.english,file_id:t.info.file_id,post_id:e.info.post_id,isSeries:o,time:0},options:{intro_end:t.options.intro_end,intro_start:t.options.intro_start,previously_start:t.options.previously_start,previously_end:t.options.previously_end,end:t.options.end,token:t.options.token},subtitle:{...t.file.subtitle},file:{m3u8:t.file.m3u8}}}function R(o){var i,r,_,s,I;(i=document.getElementById("main-scroller"))==null||i.scrollTo({top:0,behavior:"smooth"});const e=(r=n.value)==null?void 0:r.result;if(!e)return;const t=e.hls.find(B=>B.info.file_id===o);if(!t)return;const l=e.hls[e.hls.length-1].info.file_id===t.info.file_id;c.value={vast2:e.vast2,image:{cover:((_=e.image.cover)==null?void 0:_.jpg)||"",cover_webp:((s=e.image.cover)==null?void 0:s.webp)||""},info:{displayName:t.info.episode_name||"",title:e.info.title.local||e.info.title.english,file_id:t.info.file_id,post_id:e.info.post_id,isSeries:!0,time:0},options:{isLastEpisode:l,intro_end:t.options.intro_end,intro_start:t.options.intro_start,previously_start:t.options.previously_start,previously_end:t.options.previously_end,end:t.options.end,token:t.options.token},subtitle:{...t.file.subtitle},file:{m3u8:t.file.m3u8}},(I=E.value)==null||I.updatePlayerData.bind(E.value.playerInstance)(c.value,{episodeChanged:!0,position:0})}function Y(o){var i;if(!c.value||!E)return;const e=c.value.info.file_id,t=c.value.info.post_id,l=(i=c.value)==null?void 0:i.options.token;o.duration&&te(t,e,Math.floor(o.currentTime),Math.floor(o.duration),l)}function T(){var i,r;const o=(i=c.value)==null?void 0:i.info.file_id,e=(r=n.value)==null?void 0:r.result;if(!e)return;const t=e.hls.find(_=>_.info.file_id===o);if(!t)return;const l=e.hls[e.hls.indexOf(t)+1];l&&R(l.info.file_id)}async function ee(){p.value=!0,n.value=await N.API.actions.stream(Number(g.value),y.query.free==="true"),p.value=!1}let A=!1,M=0;function te(o,e,t,l,i){A||t===M||!h.user||t%30===0&&t>0&&(M=t,A=!0,N.API.actions.observer(o,e,h.user.user_id,t,l,i),A=!1)}($==null?void 0:$.value)!==void 0&&pe($,o=>{var e;o&&((e=E.value)==null||e.pause())}),_e(async()=>{var t,l,i,r,_;const o=y.query.free==="true";if(!o&&!h.user){for(a.toggleAuth(!0);a.auth.value;)await N.core.delay(300);if(!h.user){P.ignoreNextRoute(),H.push("/menu/home");return}}if(!o&&!((t=h.user)!=null&&t.user_allowed_to_stream)){p.value=!1;return}if(S.value=!0,n.value=await ve("STREAM::"+g.value,()=>N.API.actions.stream(Number(g.value),o)),p.value=!1,(l=n.value)!=null&&l.error&&k(n.value.msg,"ERROR"),!((i=n.value)!=null&&i.result))return;(r=n.value.result.image.cover)!=null&&r.webp&&U((_=n.value.result.image.cover)==null?void 0:_.webp);const e=n.value.result.hls.length>1;n.value.result.continue_watching?c.value=J(e):c.value=X(e),me("lastWatchedTitle").value=Number(g.value)}),ge(()=>{var o;U(""),(o=u.setDefaultStatus)==null||o.call(u),clearInterval(G)}),he(()=>{var o,e,t;c.value&&((o=n.value)!=null&&o.result.info.title.english)&&((t=u.setWatchingStatus)==null||t.call(u,(e=n.value)==null?void 0:e.result.info.title.english))});const V=C(()=>{var o;return(o=n.value)==null?void 0:o.result.hls.map(e=>({file_id:e.info.file_id,season:e.info.season,episode:e.info.episode,episode_number:e.info.episode_number}))});return(o,e)=>{const t=we,l=ke,i=$e,r=Le,_=Ee,s=Fe;return v(),m("div",qe,[f(S)?f(p)||!f(c)?(v(),m("div",We,[Ue,d("span",null,[b(r,{class:"flex",type:"triangle"})]),d("p",null,x(o.$t("loading")),1)])):(v(),m("div",Ze,[b(_,{ref_key:"player",ref:E,"player-data":f(c),onOnProgress:Y,onReloadPlayer:ee,onPlayNextEpisode:T,onOnVideoEnded:T},null,8,["player-data"]),f(c).info.isSeries&&f(V)?(v(),ye(s,{key:0,data:f(V),"selected-episode":Number(f(c).info.file_id),onSelected:R},null,8,["data","selected-episode"])):be("",!0)])):(v(),m("div",ze,[b(t,{name:"ph:warning-fill",class:"text-[7em] text-bg-10"}),d("h4",null,x(o.$t("notAllowedToWatchStream")),1),b(i,{to:"/pricing",class:"min-w-[12em]"},{default:W(()=>[b(l,{class:"btn-primary-outline w-full text-sm"},{default:W(()=>[b(t,{name:"ph:shopping-cart-fill"}),Q(" "+x(o.$t("pricing.buyNow")),1)]),_:1})]),_:1})]))])}}});export{Xe as default};
