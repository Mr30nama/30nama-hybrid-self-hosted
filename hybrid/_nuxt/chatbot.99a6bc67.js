var We=Object.defineProperty;var Ye=(n,e,t)=>e in n?We(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var l=(n,e,t)=>(Ye(n,typeof e!="symbol"?e+"":e,t),t);import{d as D,r as N,o as Se,g as y,h as b,k as d,i as E,l as H,j as C,m as Be,_ as Je,n as je,p as Xe,q as Qe,s as ie,t as K,v as re,w as Ze,c as et,x as tt,y as st,z as X,F as Ae,A as Ce,T as nt,B as it,C as Le,D as rt,E as fe,G as ot,H as at,I as ct,J as pe,K as lt,L as de,M as ht,N as ut,O as ft,P as pt}from"./entry.579b4528.js";/*
 * @license
 *
 * Copyright (c) 2011-2014, Christopher Jeffrey. (MIT Licensed)
 * https://github.com/chjj/marked
 *
 * Copyright (c) 2018-2021, Костя Третяк. (MIT Licensed)
 * https://github.com/ts-stack/markdown
 */class x{constructor(e,t=""){l(this,"source");l(this,"flags");this.source=e.source,this.flags=t}setGroup(e,t){let s=typeof t=="string"?t:t.source;return s=s.replace(/(^|[^\[])\^/g,"$1"),this.source=this.source.replace(e,s),this}getRegexp(){return new RegExp(this.source,this.flags)}}/**
 * @license
 *
 * Copyright (c) 2011-2014, Christopher Jeffrey. (MIT Licensed)
 * https://github.com/chjj/marked
 *
 * Copyright (c) 2018-2021, Костя Третяк. (MIT Licensed)
 * https://github.com/ts-stack/markdown
 */const dt=/[&<>"']/,gt=/[&<>"']/g,ge={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},mt=/[<>"']|&(?!#?\w+;)/,yt=/[<>"']|&(?!#?\w+;)/g;function bt(n,e){if(e){if(dt.test(n))return n.replace(gt,t=>ge[t])}else if(mt.test(n))return n.replace(yt,t=>ge[t]);return n}function _t(n){return n.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,function(e,t){return t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}/**
 * @license
 *
 * Copyright (c) 2018-2021, Костя Третяк. (MIT Licensed)
 * https://github.com/ts-stack/markdown
 */var h;(function(n){n[n.space=1]="space",n[n.text=2]="text",n[n.paragraph=3]="paragraph",n[n.heading=4]="heading",n[n.listStart=5]="listStart",n[n.listEnd=6]="listEnd",n[n.looseItemStart=7]="looseItemStart",n[n.looseItemEnd=8]="looseItemEnd",n[n.listItemStart=9]="listItemStart",n[n.listItemEnd=10]="listItemEnd",n[n.blockquoteStart=11]="blockquoteStart",n[n.blockquoteEnd=12]="blockquoteEnd",n[n.code=13]="code",n[n.table=14]="table",n[n.html=15]="html",n[n.hr=16]="hr"})(h||(h={}));class wt{constructor(){l(this,"gfm",!0);l(this,"tables",!0);l(this,"breaks",!1);l(this,"pedantic",!1);l(this,"sanitize",!1);l(this,"sanitizer");l(this,"mangle",!0);l(this,"smartLists",!1);l(this,"silent",!1);l(this,"highlight");l(this,"langPrefix","lang-");l(this,"smartypants",!1);l(this,"headerPrefix","");l(this,"renderer");l(this,"xhtml",!1);l(this,"escape",bt);l(this,"unescape",_t);l(this,"isNoP")}}/**
 * @license
 *
 * Copyright (c) 2011-2014, Christopher Jeffrey. (MIT Licensed)
 * https://github.com/chjj/marked
 *
 * Copyright (c) 2018-2021, Костя Третяк. (MIT Licensed)
 * https://github.com/ts-stack/markdown
 */class Oe{constructor(e){l(this,"options");this.options=e||L.options}code(e,t,s,i){if(this.options.highlight){const c=this.options.highlight(e,t);c!=null&&c!==e&&(s=!0,e=c)}const r=s?e:this.options.escape(e,!0);return t?`
<pre><code class="${this.options.langPrefix+this.options.escape(t,!0)}">${r}
</code></pre>
`:`
<pre><code>${r}
</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e){return e}heading(e,t,s){const i=this.options.headerPrefix+s.toLowerCase().replace(/[^\w]+/g,"-");return`<h${t} id="${i}">${e}</h${t}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,t){const s=t?"ol":"ul";return`
<${s}>
${e}</${s}>
`}listitem(e){return"<li>"+e+`</li>
`}paragraph(e){return"<p>"+e+`</p>
`}table(e,t){return`
<table>
<thead>
${e}</thead>
<tbody>
${t}</tbody>
</table>
`}tablerow(e){return`<tr>
`+e+`</tr>
`}tablecell(e,t){const s=t.header?"th":"td";return(t.align?"<"+s+' style="text-align:'+t.align+'">':"<"+s+">")+e+"</"+s+`>
`}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,s){if(this.options.sanitize){let r;try{r=decodeURIComponent(this.options.unescape(e)).replace(/[^\w:]/g,"").toLowerCase()}catch{return s}if(r.indexOf("javascript:")===0||r.indexOf("vbscript:")===0||r.indexOf("data:")===0)return s}let i='<a href="'+e+'"';return t&&(i+=' title="'+t+'"'),i+=">"+s+"</a>",i}image(e,t,s){let i='<img src="'+e+'" alt="'+s+'"';return t&&(i+=' title="'+t+'"'),i+=this.options.xhtml?"/>":">",i}text(e){return e}}/**
 * @license
 *
 * Copyright (c) 2011-2014, Christopher Jeffrey. (MIT Licensed)
 * https://github.com/chjj/marked
 *
 * Copyright (c) 2018-2021, Костя Третяк. (MIT Licensed)
 * https://github.com/ts-stack/markdown
 */class A{constructor(e,t,s=L.options,i){l(this,"staticThis");l(this,"links");l(this,"options");l(this,"rules");l(this,"renderer");l(this,"inLink");l(this,"hasRulesGfm");l(this,"ruleCallbacks");if(this.staticThis=e,this.links=t,this.options=s,this.renderer=i||this.options.renderer||new Oe(this.options),!this.links)throw new Error("InlineLexer requires 'links' parameter.");this.setRules()}static output(e,t,s){return new this(this,t,s).output(e)}static getRulesBase(){if(this.rulesBase)return this.rulesBase;const e={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ <>]+(@|:\/)[^ <>]+)>/,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^<'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)([\s\S]*?[^`])\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/,_inside:/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,_href:/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/};return e.link=new x(e.link).setGroup("inside",e._inside).setGroup("href",e._href).getRegexp(),e.reflink=new x(e.reflink).setGroup("inside",e._inside).getRegexp(),this.rulesBase=e}static getRulesPedantic(){return this.rulesPedantic?this.rulesPedantic:this.rulesPedantic={...this.getRulesBase(),strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}}static getRulesGfm(){if(this.rulesGfm)return this.rulesGfm;const e=this.getRulesBase(),t=new x(e.escape).setGroup("])","~|])").getRegexp(),s=new x(e.text).setGroup("]|","~]|").setGroup("|","|https?://|").getRegexp();return this.rulesGfm={...e,escape:t,url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:s}}static getRulesBreaks(){if(this.rulesBreaks)return this.rulesBreaks;const e=this.getRulesGfm(),t=this.getRulesGfm();return this.rulesBreaks={...t,br:new x(e.br).setGroup("{2,}","*").getRegexp(),text:new x(t.text).setGroup("{2,}","*").getRegexp()}}setRules(){this.options.gfm?this.options.breaks?this.rules=this.staticThis.getRulesBreaks():this.rules=this.staticThis.getRulesGfm():this.options.pedantic?this.rules=this.staticThis.getRulesPedantic():this.rules=this.staticThis.getRulesBase(),this.hasRulesGfm=this.rules.url!==void 0}output(e){let t,s="";for(;e;){if(t=this.rules.escape.exec(e)){e=e.substring(t[0].length),s+=t[1];continue}if(t=this.rules.autolink.exec(e)){let i,r;e=e.substring(t[0].length),t[2]==="@"?(i=this.options.escape(t[1].charAt(6)===":"?this.mangle(t[1].substring(7)):this.mangle(t[1])),r=this.mangle("mailto:")+i):(i=this.options.escape(t[1]),r=i),s+=this.renderer.link(r,null,i);continue}if(!this.inLink&&this.hasRulesGfm&&(t=this.rules.url.exec(e))){e=e.substring(t[0].length);const i=this.options.escape(t[1]),r=i;s+=this.renderer.link(r,null,i);continue}if(t=this.rules.tag.exec(e)){!this.inLink&&/^<a /i.test(t[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(t[0])&&(this.inLink=!1),e=e.substring(t[0].length),s+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):this.options.escape(t[0]):t[0];continue}if(t=this.rules.link.exec(e)){e=e.substring(t[0].length),this.inLink=!0,s+=this.outputLink(t,{href:t[2],title:t[3]}),this.inLink=!1;continue}if((t=this.rules.reflink.exec(e))||(t=this.rules.nolink.exec(e))){e=e.substring(t[0].length);const i=(t[2]||t[1]).replace(/\s+/g," "),r=this.links[i.toLowerCase()];if(!r||!r.href){s+=t[0].charAt(0),e=t[0].substring(1)+e;continue}this.inLink=!0,s+=this.outputLink(t,r),this.inLink=!1;continue}if(t=this.rules.strong.exec(e)){e=e.substring(t[0].length),s+=this.renderer.strong(this.output(t[2]||t[1]));continue}if(t=this.rules.em.exec(e)){e=e.substring(t[0].length),s+=this.renderer.em(this.output(t[2]||t[1]));continue}if(t=this.rules.code.exec(e)){e=e.substring(t[0].length),s+=this.renderer.codespan(this.options.escape(t[2].trim(),!0));continue}if(t=this.rules.br.exec(e)){e=e.substring(t[0].length),s+=this.renderer.br();continue}if(this.hasRulesGfm&&(t=this.rules.del.exec(e))){e=e.substring(t[0].length),s+=this.renderer.del(this.output(t[1]));continue}if(t=this.rules.text.exec(e)){e=e.substring(t[0].length),s+=this.renderer.text(this.options.escape(this.smartypants(t[0])));continue}if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}return s}outputLink(e,t){const s=this.options.escape(t.href),i=t.title?this.options.escape(t.title):null;return e[0].charAt(0)!=="!"?this.renderer.link(s,i,this.output(e[1])):this.renderer.image(s,i,this.options.escape(e[1]))}smartypants(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/([{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/([{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e}mangle(e){if(!this.options.mangle)return e;let t="";const s=e.length;for(let i=0;i<s;i++){let r;Math.random()>.5&&(r="x"+e.charCodeAt(i).toString(16)),t+="&#"+r+";"}return t}}l(A,"rulesBase",null),l(A,"rulesPedantic",null),l(A,"rulesGfm",null),l(A,"rulesBreaks",null);/**
 * @license
 *
 * Copyright (c) 2011-2014, Christopher Jeffrey. (MIT Licensed)
 * https://github.com/chjj/marked
 *
 * Copyright (c) 2018-2021, Костя Третяк. (MIT Licensed)
 * https://github.com/ts-stack/markdown
 */class Y{constructor(e){l(this,"simpleRenderers",[]);l(this,"tokens");l(this,"token");l(this,"inlineLexer");l(this,"options");l(this,"renderer");l(this,"line",0);this.tokens=[],this.token=null,this.options=e||L.options,this.renderer=this.options.renderer||new Oe(this.options)}static parse(e,t,s){return new this(s).parse(t,e)}parse(e,t){this.inlineLexer=new A(A,e,this.options,this.renderer),this.tokens=t.reverse();let s="";for(;this.next();)s+=this.tok();return s}debug(e,t){this.inlineLexer=new A(A,e,this.options,this.renderer),this.tokens=t.reverse();let s="";for(;this.next();){const i=this.tok();this.token.line=this.line+=i.split(`
`).length-1,s+=i}return s}next(){return this.token=this.tokens.pop()}getNextElement(){return this.tokens[this.tokens.length-1]}parseText(){let e=this.token.text,t;for(;(t=this.getNextElement())&&t.type==h.text;)e+=`
`+this.next().text;return this.inlineLexer.output(e)}tok(){switch(this.token.type){case h.space:return"";case h.paragraph:return this.renderer.paragraph(this.inlineLexer.output(this.token.text));case h.text:return this.options.isNoP?this.parseText():this.renderer.paragraph(this.parseText());case h.heading:return this.renderer.heading(this.inlineLexer.output(this.token.text),this.token.depth,this.token.text);case h.listStart:{let e="";const t=this.token.ordered;for(;this.next().type!=h.listEnd;)e+=this.tok();return this.renderer.list(e,t)}case h.listItemStart:{let e="";for(;this.next().type!=h.listItemEnd;)e+=this.token.type==h.text?this.parseText():this.tok();return this.renderer.listitem(e)}case h.looseItemStart:{let e="";for(;this.next().type!=h.listItemEnd;)e+=this.tok();return this.renderer.listitem(e)}case h.code:return this.renderer.code(this.token.text,this.token.lang,this.token.escaped,this.token.meta);case h.table:{let e="",t="",s;s="";for(let i=0;i<this.token.header.length;i++){const r={header:!0,align:this.token.align[i]},o=this.inlineLexer.output(this.token.header[i]);s+=this.renderer.tablecell(o,r)}e+=this.renderer.tablerow(s);for(const i of this.token.cells){s="";for(let r=0;r<i.length;r++)s+=this.renderer.tablecell(this.inlineLexer.output(i[r]),{header:!1,align:this.token.align[r]});t+=this.renderer.tablerow(s)}return this.renderer.table(e,t)}case h.blockquoteStart:{let e="";for(;this.next().type!=h.blockquoteEnd;)e+=this.tok();return this.renderer.blockquote(e)}case h.hr:return this.renderer.hr();case h.html:{const e=!this.token.pre&&!this.options.pedantic?this.inlineLexer.output(this.token.text):this.token.text;return this.renderer.html(e)}default:{if(this.simpleRenderers.length){for(let t=0;t<this.simpleRenderers.length;t++)if(this.token.type=="simpleRule"+(t+1))return this.simpleRenderers[t].call(this.renderer,this.token.execArr)}const e=`Token with "${this.token.type}" type was not found.`;if(this.options.silent)console.log(e);else throw new Error(e)}}}}/**
 * @license
 *
 * Copyright (c) 2011-2014, Christopher Jeffrey. (MIT Licensed)
 * https://github.com/chjj/marked
 *
 * Copyright (c) 2018-2021, Костя Третяк. (MIT Licensed)
 * https://github.com/ts-stack/markdown
 */class L{static setOptions(e){return Object.assign(this.options,e),this}static setBlockRule(e,t=()=>""){return T.simpleRules.push(e),this.simpleRenderers.push(t),this}static parse(e,t){try{t={...this.options,...t};const{tokens:s,links:i}=this.callBlockLexer(e,t);return this.callParser(s,i,t)}catch(s){return this.callMe(s)}}static debug(e,t=this.options){const{tokens:s,links:i}=this.callBlockLexer(e,t);let r=s.slice();const o=new Y(t);o.simpleRenderers=this.simpleRenderers;const c=o.debug(i,s);return r=r.map(a=>{a.type=h[a.type]||a.type;const f=a.line;return delete a.line,f?{line:f,...a}:a}),{tokens:r,links:i,result:c}}static callBlockLexer(e="",t){if(typeof e!="string")throw new Error(`Expected that the 'src' parameter would have a 'string' type, got '${typeof e}'`);return e=e.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,`
`).replace(/^ +$/gm,""),T.lex(e,t,!0)}static callParser(e,t,s){if(this.simpleRenderers.length){const i=new Y(s);return i.simpleRenderers=this.simpleRenderers,i.parse(t,e)}else return Y.parse(e,t,s)}static callMe(e){if(e.message+=`
Please report this to https://github.com/ts-stack/markdown`,this.options.silent)return"<p>An error occured:</p><pre>"+this.options.escape(e.message+"",!0)+"</pre>";throw e}}l(L,"options",new wt),l(L,"simpleRenderers",[]);/**
 * @license
 *
 * Copyright (c) 2011-2014, Christopher Jeffrey. (MIT Licensed)
 * https://github.com/chjj/marked
 *
 * Copyright (c) 2018-2021, Костя Третяк. (MIT Licensed)
 * https://github.com/ts-stack/markdown
 */class T{constructor(e,t){l(this,"staticThis");l(this,"rules");l(this,"options");l(this,"links",{});l(this,"tokens",[]);l(this,"hasRulesGfm");l(this,"hasRulesTables");this.staticThis=e,this.options=t||L.options,this.setRules()}static lex(e,t,s,i){return new this(this,t).getTokens(e,s,i)}static getRulesBase(){if(this.rulesBase)return this.rulesBase;const e={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/,bullet:/(?:[*+-]|\d+\.)/,item:/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/};e.item=new x(e.item,"gm").setGroup(/bull/g,e.bullet).getRegexp(),e.list=new x(e.list).setGroup(/bull/g,e.bullet).setGroup("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))").setGroup("def","\\n+(?="+e.def.source+")").getRegexp();const t="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b";return e.html=new x(e.html).setGroup("comment",/<!--[\s\S]*?-->/).setGroup("closed",/<(tag)[\s\S]+?<\/\1>/).setGroup("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/).setGroup(/tag/g,t).getRegexp(),e.paragraph=new x(e.paragraph).setGroup("hr",e.hr).setGroup("heading",e.heading).setGroup("lheading",e.lheading).setGroup("blockquote",e.blockquote).setGroup("tag","<"+t).setGroup("def",e.def).getRegexp(),this.rulesBase=e}static getRulesGfm(){if(this.rulesGfm)return this.rulesGfm;const e=this.getRulesBase(),t={...e,fences:/^ *(`{3,}|~{3,})[ \.]*((\S+)? *[^\n]*)\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/},s=t.fences.source.replace("\\1","\\2"),i=e.list.source.replace("\\1","\\3");return t.paragraph=new x(e.paragraph).setGroup("(?!",`(?!${s}|${i}|`).getRegexp(),this.rulesGfm=t}static getRulesTable(){return this.rulesTables?this.rulesTables:this.rulesTables={...this.getRulesGfm(),nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}}setRules(){this.options.gfm?this.options.tables?this.rules=this.staticThis.getRulesTable():this.rules=this.staticThis.getRulesGfm():this.rules=this.staticThis.getRulesBase(),this.hasRulesGfm=this.rules.fences!==void 0,this.hasRulesTables=this.rules.table!==void 0}getTokens(e,t,s){let i=e,r;e:for(;i;){if((r=this.rules.newline.exec(i))&&(i=i.substring(r[0].length),r[0].length>1&&this.tokens.push({type:h.space})),r=this.rules.code.exec(i)){i=i.substring(r[0].length);const o=r[0].replace(/^ {4}/gm,"");this.tokens.push({type:h.code,text:this.options.pedantic?o:o.replace(/\n+$/,"")});continue}if(this.hasRulesGfm&&(r=this.rules.fences.exec(i))){i=i.substring(r[0].length),this.tokens.push({type:h.code,meta:r[2],lang:r[3],text:r[4]||""});continue}if(r=this.rules.heading.exec(i)){i=i.substring(r[0].length),this.tokens.push({type:h.heading,depth:r[1].length,text:r[2]});continue}if(t&&this.hasRulesTables&&(r=this.rules.nptable.exec(i))){i=i.substring(r[0].length);const o={type:h.table,header:r[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:[]};for(let a=0;a<o.align.length;a++)/^ *-+: *$/.test(o.align[a])?o.align[a]="right":/^ *:-+: *$/.test(o.align[a])?o.align[a]="center":/^ *:-+ *$/.test(o.align[a])?o.align[a]="left":o.align[a]=null;const c=r[3].replace(/\n$/,"").split(`
`);for(let a=0;a<c.length;a++)o.cells[a]=c[a].split(/ *\| */);this.tokens.push(o);continue}if(r=this.rules.lheading.exec(i)){i=i.substring(r[0].length),this.tokens.push({type:h.heading,depth:r[2]==="="?1:2,text:r[1]});continue}if(r=this.rules.hr.exec(i)){i=i.substring(r[0].length),this.tokens.push({type:h.hr});continue}if(r=this.rules.blockquote.exec(i)){i=i.substring(r[0].length),this.tokens.push({type:h.blockquoteStart});const o=r[0].replace(/^ *> ?/gm,"");this.getTokens(o),this.tokens.push({type:h.blockquoteEnd});continue}if(r=this.rules.list.exec(i)){i=i.substring(r[0].length);const o=r[2];this.tokens.push({type:h.listStart,ordered:o.length>1});const c=r[0].match(this.rules.item),a=c.length;let f=!1,m,p,_;for(let B=0;B<a;B++){let w=c[B];m=w.length,w=w.replace(/^ *([*+-]|\d+\.) +/,""),w.indexOf(`
 `)!==-1&&(m-=w.length,w=this.options.pedantic?w.replace(/^ {1,4}/gm,""):w.replace(new RegExp("^ {1,"+m+"}","gm"),"")),this.options.smartLists&&B!==a-1&&(p=this.staticThis.getRulesBase().bullet.exec(c[B+1])[0],o!==p&&!(o.length>1&&p.length>1)&&(i=c.slice(B+1).join(`
`)+i,B=a-1)),_=f||/\n\n(?!\s*$)/.test(w),B!==a-1&&(f=w.charAt(w.length-1)===`
`,_||(_=f)),this.tokens.push({type:_?h.looseItemStart:h.listItemStart}),this.getTokens(w,!1,s),this.tokens.push({type:h.listItemEnd})}this.tokens.push({type:h.listEnd});continue}if(r=this.rules.html.exec(i)){i=i.substring(r[0].length);const o=r[1],c=o==="pre"||o==="script"||o==="style";this.tokens.push({type:this.options.sanitize?h.paragraph:h.html,pre:!this.options.sanitizer&&c,text:r[0]});continue}if(t&&(r=this.rules.def.exec(i))){i=i.substring(r[0].length),this.links[r[1].toLowerCase()]={href:r[2],title:r[3]};continue}if(t&&this.hasRulesTables&&(r=this.rules.table.exec(i))){i=i.substring(r[0].length);const o={type:h.table,header:r[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:[]};for(let a=0;a<o.align.length;a++)/^ *-+: *$/.test(o.align[a])?o.align[a]="right":/^ *:-+: *$/.test(o.align[a])?o.align[a]="center":/^ *:-+ *$/.test(o.align[a])?o.align[a]="left":o.align[a]=null;const c=r[3].replace(/(?: *\| *)?\n$/,"").split(`
`);for(let a=0;a<c.length;a++)o.cells[a]=c[a].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(o);continue}if(this.staticThis.simpleRules.length){const o=this.staticThis.simpleRules;for(let c=0;c<o.length;c++)if(r=o[c].exec(i)){i=i.substring(r[0].length);const a="simpleRule"+(c+1);this.tokens.push({type:a,execArr:r});continue e}}if(t&&(r=this.rules.paragraph.exec(i))){i=i.substring(r[0].length),r[1].slice(-1)===`
`?this.tokens.push({type:h.paragraph,text:r[1].slice(0,-1)}):this.tokens.push({type:this.tokens.length>0?h.paragraph:h.text,text:r[1]});continue}if(r=this.rules.text.exec(i)){i=i.substring(r[0].length),this.tokens.push({type:h.text,text:r[0]});continue}if(i)throw new Error("Infinite loop on byte: "+i.charCodeAt(0)+`, near text '${i.slice(0,30)}...'`)}return{tokens:this.tokens,links:this.links}}}l(T,"simpleRules",[]),l(T,"rulesBase",null),l(T,"rulesGfm",null),l(T,"rulesTables",null);const kt=n=>(Xe("data-v-932a1ca8"),n=n(),Qe(),n),vt={class:"flex justify-start"},xt={class:"flex items-start gap-2 max-w-[80ch]"},Et={class:"flex items-center w-12 h-12 -translate-y-2 rounded-full bg-bg-13/50 p-3 shrink-0 shadow-md shadow-black/20"},Rt={class:"flex py-2 px-4 shadow-md shadow-black/20 rounded-2xl pl-8 relative bg-bg-13/50 rounded-tl-lg overflow-y-auto",dir:"auto"},St=kt(()=>d("span",{class:"w-1 h-1/2 bg-primary-500 rounded-full shrink-0 left-3 top-[50%] -translate-y-1/2 flex absolute shadow-[8px_0_32px_0] shadow-primary-500/50"},null,-1)),Bt={key:1,class:"inline",dir:"auto"},At=["innerHTML"],Ct=D({__name:"ChatbotBubbleAI",props:{isBusy:{type:Boolean},content:{}},setup(n){const e=N();return Se(()=>$fetch("/testmd.md").then(t=>e.value=t)),(t,s)=>{const i=Je,r=je;return y(),b("div",vt,[d("div",xt,[d("div",Et,[E(i,{compact:""})]),d("div",Rt,[St,t.isBusy?(y(),H(r,{key:0,type:"square"})):t.content?(y(),b("div",Bt,[d("div",{class:"inline select-text content",dir:"auto",innerHTML:C(L).parse(t.content,{gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1})},null,8,At)])):Be("",!0)])])])}}});const Lt=ie(Ct,[["__scopeId","data-v-932a1ca8"]]),Ot={class:"w-full flex justify-end"},Tt={class:"flex items-start gap-2 max-w-[80ch]"},Nt={class:"flex py-2 px-4 rounded-2xl relative bg-bg-9/30 rounded-tr-lg shadow-lg overflow-hidden",dir:"auto"},$t={class:"font-Main whitespace-pre-line break-all select-text"},qt={class:"flex items-center text-[1.4rem] w-12 h-12 justify-center shadow-lg -translate-y-2 rounded-full bg-bg-9/30 p-3 shrink-0"},It=D({__name:"ChatbotBubbleUser",props:{content:{}},setup(n){return(e,t)=>{const s=re;return y(),b("div",Ot,[d("div",Tt,[d("div",Nt,[d("pre",$t,K(e.content),1)]),d("div",qt,[E(s,{name:"ph:user-bold"})])])])}}}),Te=Ze("gap30",{state:()=>({conversation:[],busy:!1})}),Dt={"aria-label":"messages",class:"w-full h-full relative"},Gt={class:"max-w-[100ch] w-full",dir:"ltr"},Mt={key:"typing",class:"wrapper w-full"},Ut=D({__name:"ChatbotMessages",setup(n){const e=Te(),t=et(()=>e.conversation),s=N(),i=N(),r=tt(i);st(s,o,{childList:!0});async function o(){var c;r.value&&(await it(),(c=s.value)==null||c.scrollTo({top:s.value.scrollHeight,behavior:"instant"}))}return(c,a)=>{const f=Lt,m=It;return y(),b("section",Dt,[d("div",{id:"gap30-chat-container",ref_key:"chatContainer",ref:s,class:"flex-col items-center p-8 gap-8 absolute flex inset-0 overflow-y-auto"},[d("div",Gt,[E(nt,{name:"chats",tag:"div",class:"flex flex-col gap-8 w-full",onBeforeEnter:o},{default:X(()=>[(y(!0),b(Ae,null,Ce(C(t),(p,_)=>(y(),b("div",{key:_,class:"wrapper"},[p.role==="assistant"?(y(),H(f,{key:0,content:p.content},null,8,["content"])):(y(),H(m,{key:1,content:p.content},null,8,["content"]))]))),128)),C(e).busy?(y(),b("div",Mt,[E(f,{"is-busy":""})])):Be("",!0)]),_:1}),d("div",{ref_key:"anchor",ref:i},null,512)])],512)])}}});const Pt=ie(Ut,[["__scopeId","data-v-413c722c"]]),S=Object.create(null);S.open="0";S.close="1";S.ping="2";S.pong="3";S.message="4";S.upgrade="5";S.noop="6";const V=Object.create(null);Object.keys(S).forEach(n=>{V[S[n]]=n});const Q={type:"error",data:"parser error"},Ne=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",$e=typeof ArrayBuffer=="function",qe=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,oe=({type:n,data:e},t,s)=>Ne&&e instanceof Blob?t?s(e):me(e,s):$e&&(e instanceof ArrayBuffer||qe(e))?t?s(e):me(new Blob([e]),s):s(S[n]+(e||"")),me=(n,e)=>{const t=new FileReader;return t.onload=function(){const s=t.result.split(",")[1];e("b"+(s||""))},t.readAsDataURL(n)};function ye(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let J;function Vt(n,e){if(Ne&&n.data instanceof Blob)return n.data.arrayBuffer().then(ye).then(e);if($e&&(n.data instanceof ArrayBuffer||qe(n.data)))return e(ye(n.data));oe(n,!1,t=>{J||(J=new TextEncoder),e(J.encode(t))})}const be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",I=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<be.length;n++)I[be.charCodeAt(n)]=n;const Ft=n=>{let e=n.length*.75,t=n.length,s,i=0,r,o,c,a;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const f=new ArrayBuffer(e),m=new Uint8Array(f);for(s=0;s<t;s+=4)r=I[n.charCodeAt(s)],o=I[n.charCodeAt(s+1)],c=I[n.charCodeAt(s+2)],a=I[n.charCodeAt(s+3)],m[i++]=r<<2|o>>4,m[i++]=(o&15)<<4|c>>2,m[i++]=(c&3)<<6|a&63;return f},zt=typeof ArrayBuffer=="function",ae=(n,e)=>{if(typeof n!="string")return{type:"message",data:Ie(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:Ht(n.substring(1),e)}:V[t]?n.length>1?{type:V[t],data:n.substring(1)}:{type:V[t]}:Q},Ht=(n,e)=>{if(zt){const t=Ft(n);return Ie(t,e)}else return{base64:!0,data:n}},Ie=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},De=String.fromCharCode(30),Kt=(n,e)=>{const t=n.length,s=new Array(t);let i=0;n.forEach((r,o)=>{oe(r,!1,c=>{s[o]=c,++i===t&&e(s.join(De))})})},Wt=(n,e)=>{const t=n.split(De),s=[];for(let i=0;i<t.length;i++){const r=ae(t[i],e);if(s.push(r),r.type==="error")break}return s};function Yt(){return new TransformStream({transform(n,e){Vt(n,t=>{const s=t.length;let i;if(s<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,s);else if(s<65536){i=new Uint8Array(3);const r=new DataView(i.buffer);r.setUint8(0,126),r.setUint16(1,s)}else{i=new Uint8Array(9);const r=new DataView(i.buffer);r.setUint8(0,127),r.setBigUint64(1,BigInt(s))}n.data&&typeof n.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(t)})}})}let j;function G(n){return n.reduce((e,t)=>e+t.length,0)}function M(n,e){if(n[0].length===e)return n.shift();const t=new Uint8Array(e);let s=0;for(let i=0;i<e;i++)t[i]=n[0][s++],s===n[0].length&&(n.shift(),s=0);return n.length&&s<n[0].length&&(n[0]=n[0].slice(s)),t}function Jt(n,e){j||(j=new TextDecoder);const t=[];let s=0,i=-1,r=!1;return new TransformStream({transform(o,c){for(t.push(o);;){if(s===0){if(G(t)<1)break;const a=M(t,1);r=(a[0]&128)===128,i=a[0]&127,i<126?s=3:i===126?s=1:s=2}else if(s===1){if(G(t)<2)break;const a=M(t,2);i=new DataView(a.buffer,a.byteOffset,a.length).getUint16(0),s=3}else if(s===2){if(G(t)<8)break;const a=M(t,8),f=new DataView(a.buffer,a.byteOffset,a.length),m=f.getUint32(0);if(m>Math.pow(2,53-32)-1){c.enqueue(Q);break}i=m*Math.pow(2,32)+f.getUint32(4),s=3}else{if(G(t)<i)break;const a=M(t,i);c.enqueue(ae(r?a:j.decode(a),e)),s=0}if(i===0||i>n){c.enqueue(Q);break}}}})}const Ge=4;function g(n){if(n)return jt(n)}function jt(n){for(var e in g.prototype)n[e]=g.prototype[e];return n}g.prototype.on=g.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};g.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};g.prototype.off=g.prototype.removeListener=g.prototype.removeAllListeners=g.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var s,i=0;i<t.length;i++)if(s=t[i],s===e||s.fn===e){t.splice(i,1);break}return t.length===0&&delete this._callbacks["$"+n],this};g.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(t){t=t.slice(0);for(var s=0,i=t.length;s<i;++s)t[s].apply(this,e)}return this};g.prototype.emitReserved=g.prototype.emit;g.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};g.prototype.hasListeners=function(n){return!!this.listeners(n).length};const k=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function Me(n,...e){return e.reduce((t,s)=>(n.hasOwnProperty(s)&&(t[s]=n[s]),t),{})}const Xt=k.setTimeout,Qt=k.clearTimeout;function W(n,e){e.useNativeTimers?(n.setTimeoutFn=Xt.bind(k),n.clearTimeoutFn=Qt.bind(k)):(n.setTimeoutFn=k.setTimeout.bind(k),n.clearTimeoutFn=k.clearTimeout.bind(k))}const Zt=1.33;function es(n){return typeof n=="string"?ts(n):Math.ceil((n.byteLength||n.size)*Zt)}function ts(n){let e=0,t=0;for(let s=0,i=n.length;s<i;s++)e=n.charCodeAt(s),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(s++,t+=4);return t}function ss(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function ns(n){let e={},t=n.split("&");for(let s=0,i=t.length;s<i;s++){let r=t[s].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e}class is extends Error{constructor(e,t,s){super(e),this.description=t,this.context=s,this.type="TransportError"}}class ce extends g{constructor(e){super(),this.writable=!1,W(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,s){return super.emitReserved("error",new is(e,t,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=ae(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=ss(e);return t.length?"?"+t:""}}const Ue="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Z=64,rs={};let _e=0,U=0,we;function ke(n){let e="";do e=Ue[n%Z]+e,n=Math.floor(n/Z);while(n>0);return e}function Pe(){const n=ke(+new Date);return n!==we?(_e=0,we=n):n+"."+ke(_e++)}for(;U<Z;U++)rs[Ue[U]]=U;let Ve=!1;try{Ve=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const os=Ve;function Fe(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||os))return new XMLHttpRequest}catch{}if(!e)try{return new k[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function as(){}const cs=function(){return new Fe({xdomain:!1}).responseType!=null}();class ls extends ce{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){const s=location.protocol==="https:";let i=location.port;i||(i=s?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port}const t=e&&e.forceBase64;this.supportsBinary=cs&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let s=0;this.polling&&(s++,this.once("pollComplete",function(){--s||t()})),this.writable||(s++,this.once("drain",function(){--s||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};Wt(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Kt(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Pe()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new R(this.uri(),e)}doWrite(e,t){const s=this.request({method:"POST",data:e});s.on("success",t),s.on("error",(i,r)=>{this.onError("xhr post error",i,r)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,s)=>{this.onError("xhr poll error",t,s)}),this.pollXhr=e}}class R extends g{constructor(e,t){super(),W(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=t.data!==void 0?t.data:null,this.create()}create(){var e;const t=Me(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const s=this.xhr=new Fe(t);try{s.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let i in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&s.setRequestHeader(i,this.opts.extraHeaders[i])}}catch{}if(this.method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(e=this.opts.cookieJar)===null||e===void 0||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(s.timeout=this.opts.requestTimeout),s.onreadystatechange=()=>{var i;s.readyState===3&&((i=this.opts.cookieJar)===null||i===void 0||i.parseCookies(s)),s.readyState===4&&(s.status===200||s.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof s.status=="number"?s.status:0)},0))},s.send(this.data)}catch(i){this.setTimeoutFn(()=>{this.onError(i)},0);return}typeof document<"u"&&(this.index=R.requestsCount++,R.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=as,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete R.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}R.requestsCount=0;R.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",ve);else if(typeof addEventListener=="function"){const n="onpagehide"in k?"pagehide":"unload";addEventListener(n,ve,!1)}}function ve(){for(let n in R.requests)R.requests.hasOwnProperty(n)&&R.requests[n].abort()}const le=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0))(),P=k.WebSocket||k.MozWebSocket,xe=!0,hs="arraybuffer",Ee=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class us extends ce{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,s=Ee?{}:Me(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=xe&&!Ee?t?new P(e,t):new P(e):new P(e,t,s)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],i=t===e.length-1;oe(s,this.supportsBinary,r=>{const o={};try{xe&&this.ws.send(r)}catch{}i&&le(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Pe()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!P}}class fs extends ce{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{const t=Jt(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(t).getReader(),i=Yt();i.readable.pipeTo(e.writable),this.writer=i.writable.getWriter();const r=()=>{s.read().then(({done:c,value:a})=>{c||(this.onPacket(a),r())}).catch(c=>{})};r();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this.writer.write(o).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],i=t===e.length-1;this.writer.write(s).then(()=>{i&&le(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this.transport)===null||e===void 0||e.close()}}const ps={websocket:us,webtransport:fs,polling:ls},ds=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,gs=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ee(n){if(n.length>2e3)throw"URI too long";const e=n,t=n.indexOf("["),s=n.indexOf("]");t!=-1&&s!=-1&&(n=n.substring(0,t)+n.substring(t,s).replace(/:/g,";")+n.substring(s,n.length));let i=ds.exec(n||""),r={},o=14;for(;o--;)r[gs[o]]=i[o]||"";return t!=-1&&s!=-1&&(r.source=e,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=ms(r,r.path),r.queryKey=ys(r,r.query),r}function ms(n,e){const t=/\/{2,9}/g,s=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&s.splice(0,1),e.slice(-1)=="/"&&s.splice(s.length-1,1),s}function ys(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,i,r){i&&(t[i]=r)}),t}let ze=class O extends g{constructor(e,t={}){super(),this.binaryType=hs,this.writeBuffer=[],e&&typeof e=="object"&&(t=e,e=null),e?(e=ee(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=ee(t.host).host),W(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=ns(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Ge,t.transport=e,this.id&&(t.sid=this.id);const s=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new ps[e](s)}open(){let e;if(this.opts.rememberUpgrade&&O.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",t=>this.onClose("transport close",t))}probe(e){let t=this.createTransport(e),s=!1;O.priorWebsocketSuccess=!1;const i=()=>{s||(t.send([{type:"ping",data:"probe"}]),t.once("packet",p=>{if(!s)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;O.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(m(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const _=new Error("probe error");_.transport=t.name,this.emitReserved("upgradeError",_)}}))};function r(){s||(s=!0,m(),t.close(),t=null)}const o=p=>{const _=new Error("probe error: "+p);_.transport=t.name,r(),this.emitReserved("upgradeError",_)};function c(){o("transport closed")}function a(){o("socket closed")}function f(p){t&&p.name!==t.name&&r()}const m=()=>{t.removeListener("open",i),t.removeListener("error",o),t.removeListener("close",c),this.off("close",a),this.off("upgrading",f)};t.once("open",i),t.once("error",o),t.once("close",c),this.once("close",a),this.once("upgrading",f),this.upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{s||t.open()},200):t.open()}onOpen(){if(this.readyState="open",O.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let s=0;s<this.writeBuffer.length;s++){const i=this.writeBuffer[s].data;if(i&&(t+=es(i)),s>0&&t>this.maxPayload)return this.writeBuffer.slice(0,s);t+=2}return this.writeBuffer}write(e,t,s){return this.sendPacket("message",e,t,s),this}send(e,t,s){return this.sendPacket("message",e,t,s),this}sendPacket(e,t,s,i){if(typeof t=="function"&&(i=t,t=void 0),typeof s=="function"&&(i=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const r={type:e,data:t,options:s};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},s=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():e()}):this.upgrading?s():e()),this}onError(e){O.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let s=0;const i=e.length;for(;s<i;s++)~this.transports.indexOf(e[s])&&t.push(e[s]);return t}};ze.protocol=Ge;function bs(n,e="",t){let s=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),s=ee(n)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const r=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+r+":"+s.port+e,s.href=s.protocol+"://"+r+(t&&t.port===s.port?"":":"+s.port),s}const _s=typeof ArrayBuffer=="function",ws=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,He=Object.prototype.toString,ks=typeof Blob=="function"||typeof Blob<"u"&&He.call(Blob)==="[object BlobConstructor]",vs=typeof File=="function"||typeof File<"u"&&He.call(File)==="[object FileConstructor]";function he(n){return _s&&(n instanceof ArrayBuffer||ws(n))||ks&&n instanceof Blob||vs&&n instanceof File}function F(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,s=n.length;t<s;t++)if(F(n[t]))return!0;return!1}if(he(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return F(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&F(n[t]))return!0;return!1}function xs(n){const e=[],t=n.data,s=n;return s.data=te(t,e),s.attachments=e.length,{packet:s,buffers:e}}function te(n,e){if(!n)return n;if(he(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let s=0;s<n.length;s++)t[s]=te(n[s],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=te(n[s],e));return t}return n}function Es(n,e){return n.data=se(n.data,e),delete n.attachments,n}function se(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=se(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=se(n[t],e));return n}const Rs=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Ss=5;var u;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(u||(u={}));class Bs{constructor(e){this.replacer=e}encode(e){return(e.type===u.EVENT||e.type===u.ACK)&&F(e)?this.encodeAsBinary({type:e.type===u.EVENT?u.BINARY_EVENT:u.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===u.BINARY_EVENT||e.type===u.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=xs(e),s=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(s),i}}function Re(n){return Object.prototype.toString.call(n)==="[object Object]"}class ue extends g{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const s=t.type===u.BINARY_EVENT;s||t.type===u.BINARY_ACK?(t.type=s?u.EVENT:u.ACK,this.reconstructor=new As(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(he(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const s={type:Number(e.charAt(0))};if(u[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===u.BINARY_EVENT||s.type===u.BINARY_ACK){const r=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(r,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(e.charAt(t+1)==="/"){const r=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););s.nsp=e.substring(r,t)}else s.nsp="/";const i=e.charAt(t+1);if(i!==""&&Number(i)==i){const r=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}s.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(ue.isPayloadValid(s.type,r))s.data=r;else throw new Error("invalid payload")}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case u.CONNECT:return Re(t);case u.DISCONNECT:return t===void 0;case u.CONNECT_ERROR:return typeof t=="string"||Re(t);case u.EVENT:case u.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Rs.indexOf(t[0])===-1);case u.ACK:case u.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class As{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Es(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Cs=Object.freeze(Object.defineProperty({__proto__:null,Decoder:ue,Encoder:Bs,get PacketType(){return u},protocol:Ss},Symbol.toStringTag,{value:"Module"}));function v(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const Ls=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Ke extends g{constructor(e,t,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[v(e,"open",this.onopen.bind(this)),v(e,"packet",this.onpacket.bind(this)),v(e,"error",this.onerror.bind(this)),v(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(Ls.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const s={type:u.EVENT,data:t};if(s.options={},s.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const o=this.ids++,c=t.pop();this._registerAckCallback(o,c),s.id=o}const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(e,t){var s;const i=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(i===void 0){this.acks[e]=t;return}const r=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===e&&this.sendBuffer.splice(o,1);t.call(this,new Error("operation has timed out"))},i);this.acks[e]=(...o)=>{this.io.clearTimeoutFn(r),t.apply(this,[null,...o])}}emitWithAck(e,...t){const s=this.flags.timeout!==void 0||this._opts.ackTimeout!==void 0;return new Promise((i,r)=>{t.push((o,c)=>s?o?r(o):i(c):i(o)),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...r)=>s!==this._queue[0]?void 0:(i!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(i)):(this._queue.shift(),t&&t(null,...r)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:u.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case u.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case u.EVENT:case u.BINARY_EVENT:this.onevent(e);break;case u.ACK:case u.BINARY_ACK:this.onack(e);break;case u.DISCONNECT:this.ondisconnect();break;case u.CONNECT_ERROR:this.destroy();const s=new Error(e.data.message);s.data=e.data.data,this.emitReserved("connect_error",s);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const s of t)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let s=!1;return function(...i){s||(s=!0,t.packet({type:u.ACK,id:e,data:i}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:u.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const s of t)s.apply(this,e.data)}}}function $(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}$.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=Math.floor(e*10)&1?n+t:n-t}return Math.min(n,this.max)|0};$.prototype.reset=function(){this.attempts=0};$.prototype.setMin=function(n){this.ms=n};$.prototype.setMax=function(n){this.max=n};$.prototype.setJitter=function(n){this.jitter=n};class ne extends g{constructor(e,t){var s;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,W(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((s=t.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new $({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||Cs;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new ze(this.uri,this.opts);const t=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const i=v(t,"open",function(){s.onopen(),e&&e()}),r=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),e?e(c):this.maybeReconnectOnOpen()},o=v(t,"error",r);if(this._timeout!==!1){const c=this._timeout,a=this.setTimeoutFn(()=>{i(),r(new Error("timeout")),t.close()},c);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(v(e,"ping",this.onping.bind(this)),v(e,"data",this.ondata.bind(this)),v(e,"error",this.onerror.bind(this)),v(e,"close",this.onclose.bind(this)),v(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){le(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new Ke(this,e,t),this.nsps[e]=s),s}_destroy(e){const t=Object.keys(this.nsps);for(const s of t)if(this.nsps[s].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let s=0;s<t.length;s++)this.engine.write(t[s],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},t);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const q={};function z(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=bs(n,e.path||"/socket.io"),s=t.source,i=t.id,r=t.path,o=q[i]&&r in q[i].nsps,c=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let a;return c?a=new ne(s,e):(q[i]||(q[i]=new ne(s,e)),a=q[i]),t.query&&!e.query&&(e.query=t.queryKey),a.socket(t.path,e)}Object.assign(z,{Manager:ne,Socket:Ke,io:z,connect:z});function Os(){const n=Le(),e=Te(),t=N(z("http://2.188.225.168:3469",{auth:{Authorization:n.token},autoConnect:!1})),s=N(!1);t.value.on("disconnect",()=>{console.warn("[IO] Disconnected from prompt-assist"),s.value=!1});async function i(){if(console.log("[Gap30] connect"),s.value)return;const a=new Promise(f=>t.value.on("handshake",f));s.value=!0,t.value.connect(),await a,s.value&&console.log("[Gap30] Connected")}function r(){console.log("[Gap30] disconnect"),s.value&&t.value.disconnect()}function o(){t.value.on("ask:error",a=>{console.error("[Gap30] ask:error",a)}),t.value.on("addUserMessage",a=>{console.log("[Gap30] addUserMessage",a),e.conversation.push({role:"user",content:a,createdAt:new Date})}),t.value.on("reply:full",a=>{console.log("[Gap30] reply:full",a),e.busy=!1,e.conversation.push({role:"assistant",content:a.value,createdAt:new Date})})}function c(a){console.log("[Gap30] sendMessage",a),e.busy=!0,e.conversation.push({role:"user",content:a,createdAt:new Date}),t.value.emit("ask",a)}return{connected:s,connect:i,disconnect:r,startEventListeners:o,sendMessage:c}}const Ts={class:"flex w-full items-center justify-center"},Ns={class:"w-full flex flex-col gap-6 max-w-[100ch]"},$s={class:"flex flex-wrap items-center gap-6"},qs={class:"flex gap-6 w-full items-center"},Is=d("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 0H0V30H8L8 8.34204L8 0ZM8 8.34204L7.99611 8.34485L7.99914 8.34212L7.99914 4C7.99914 6.92963 6.92984 8.96704 6.14398 9.93857C6.02543 10.063 5.91246 10.1875 5.80492 10.312C5.78418 10.3319 5.76392 10.3507 5.74418 10.3684L5.7979 10.3201C2.85283 13.7386 3.99163 17.1976 5.90023 19.4823L5.74423 19.3421C6.49593 20.0176 7.99914 22.2948 7.99914 25.9999L7.99914 21.3683L7.99706 21.3665L8 21.3684L8 8.34204Z"},null,-1),Ds=[Is],Gs=["onKeydown"],Ms=D({__name:"ChatbotInput",setup(n){const e=Os(),{textarea:t,input:s}=rt();Se(()=>{e.connect(),e.startEventListeners()});function i(){const a=document.getElementById("gap30-chat-container");a&&a.scrollTo({top:a.scrollHeight,behavior:"instant"})}async function r(){s.value&&(e.sendMessage(s.value),s.value="",t.value.focus(),await lt.core.delay(100),i())}const o=N(!1),c=[{name:"whatIsChatBot",value:"گپسی چیه؟"},{name:"whatDoesChatBotDo",value:"گپسی چیکار میکنه؟"},{name:"suggestMeAMoive",value:"یه فیلم بهم پیشنهاد بده"}];return(a,f)=>{const m=re;return y(),b("div",Ts,[d("div",Ns,[d("ul",$s,[(y(),b(Ae,null,Ce(c,p=>d("li",{key:p.name,class:"cursor-pointer border-2 px-4 py-1 rounded-full border-fonts-400 hover:border-primary-500 transition-colors"},K(p.value),1)),64))]),d("div",qs,[d("div",{class:fe(["flex flex-1 bg-bg-10 rounded-xl ltr:rounded-r-none rtl:rounded-l-none relative transition-colors",{"bg-bg-9":C(o)}])},[(y(),b("svg",{class:fe(["fill-bg-10 absolute top-0 h-full rounded-r-xl transition-colors ltr:left-full ltr:translate-x-[-0.2px] rtl:rotate-180 rtl:right-full rtl:translate-x-[0.2em]",{"fill-bg-9":C(o)}]),viewBox:"0 0 8 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ds,2)),ot(d("textarea",{ref_key:"textarea",ref:t,"onUpdate:modelValue":f[0]||(f[0]=p=>ct(s)?s.value=p:null),dir:"auto",maxlength:"256",class:"w-full resize-none p-4 max-h-[6rem]",onKeydown:[pe(de(r,["exact","prevent"]),["enter"]),f[1]||(f[1]=pe(de(p=>s.value+=`
`,["shift","exact","prevent"]),["enter"]))],onFocus:f[2]||(f[2]=p=>o.value=!0),onBlur:f[3]||(f[3]=p=>o.value=!1)},null,40,Gs),[[at,C(s)]])],2),d("div",{class:"group cursor-pointer",onClick:r},[E(m,{name:"ph:paper-plane-right-fill",class:"rtl:rotate-180 text-2xl rtl:group-hover:-translate-x-1 ltr:group-hover:translate-x-1 transition-transform"})])])])])}}}),Us={},Ps={"aria-label":"chatbot",class:"w-full h-full flex flex-col items-center justify-center rounded-xl"},Vs={class:"flex w-full justify-between flex-col flex-1"};function Fs(n,e){const t=Pt,s=Ms;return y(),b("section",Ps,[d("div",Vs,[E(t),E(s,{class:"mt-4"})])])}const zs=ie(Us,[["render",Fs]]),Hs={class:"w-full -mt-12 h-[calc(100%_+_1rem)]"},Ks={key:0,class:"flex w-full h-full flex-col items-center justify-center gap-8"},Js=D({__name:"chatbot",setup(n){const e=Le();return ht({statusCode:404}),(t,s)=>{var a;const i=re,r=ft,o=pt,c=zs;return y(),b("div",Hs,[!C(e).isLoggedIn||!((a=C(e).user)!=null&&a.user_allowed_to_stream)?(y(),b("div",Ks,[E(i,{name:"ph:warning-fill",class:"text-[7em] text-bg-10"}),d("h4",null,K(t.$t("notAllowedToUseGap30")),1),E(o,{to:"/pricing",class:"min-w-[12em]"},{default:X(()=>[E(r,{class:"btn-primary-outline w-full text-sm"},{default:X(()=>[E(i,{name:"ph:shopping-cart-fill"}),ut(" "+K(t.$t("pricing.buyNow")),1)]),_:1})]),_:1})])):(y(),H(c,{key:1}))])}}});export{Js as default};
